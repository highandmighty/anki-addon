const noun_ids=["s","p","sc","pc"],verb_ids=["INF-L","AP-ms","AP-fs","AP-mp","PERF-1s","PERF-1p","PERF-2ms","PERF-2fs","PERF-2mp","PERF-3ms","PERF-3fs","PERF-3p","IMPF-1s","IMPF-1p","IMPF-2ms","IMPF-2fs","IMPF-2mp","IMPF-3ms","IMPF-3fs","IMPF-3mp"],adj_ids=["ms-a","fs-a","mp-a","fp-a"],data_w={},data_tr={},data_wr={};function myTr(t){return t.replaceAll("е","э").replaceAll("х","кх").replaceAll("я","йа").replaceAll("ю","йу")}function stripNiqqud(t){return Array.from(t).filter(t=>{var e=t.charCodeAt(0);return 1488<=e&&e<=1514||e<=1e3&&59!==e&&34!==e||1470===e||9312<=e&&e<=9331}).join("")}function containsString(t,e){return Array.from(t).some(t=>t.textContent.includes(e))}function definePOS(){let t=document.querySelectorAll("div.container p");if(containsString(t,"Глагол"))var e="verb";else if(containsString(t,"Существительное"))var e="noun";else if(containsString(t,"Прилагательное"))var e="adjective";return console.log(`POS detected: ${e}`),e}function findRoot(){let t=document.querySelectorAll("div.container p");var e=void 0;for(let r of t)if(r.textContent.includes("Корень")){e=r.querySelector("a")?.textContent.replaceAll(" ","")||void 0;break}return console.log(`Root: ${e}`),e}function parseIDs(t){for(let e of t){let r=document.querySelector(`td.conj-td div#${e}`);if(r){data_w[e]=r.querySelector("span.menukad").textContent.trim();let a=r.querySelector("span.chaser");if(a)var n=a.textContent.replace(" ~ ","");else var n=stripNiqqud(data_w[e]);data_wr[e]=n;let i=r.querySelector("div.transcription").innerHTML;data_tr[e]=myTr(i.replace(/<b>(.*?)<\/b>/g,"$1\xb4")),console.log(`Data populated: ${data_w[e]} (${e})`)}}}function patternNoun({s:t,p:e,sc:r,pc:a}){return t?`${t}${e?` (${e})`:""}${r?a?`, ${r} (${a})`:`, ${r}`:""}`:e?`${e}${a?`, ${a}`:""}`:void 0}function patternAdj(t){return`${t["ms-a"]}${DELIMETER} ${t["fs-a"]}${DELIMETER} ${t["mp-a"]}`}function patternVerb(t,e=""){return void 0!==VERB_PATTERN&&"past"===VERB_PATTERN?`${t["PERF-1s"]}${DELIMETER} ${t["PERF-1p"]}${e}<br/>${t["PERF-2ms"]}, ${t["PERF-2fs"]}${DELIMETER} ${t["PERF-2mp"]}${e}<br/>${t["PERF-3ms"]}, ${t["PERF-3fs"]}${DELIMETER} ${t["PERF-3p"]}${e}<br/>${t["INF-L"]}`:void 0!==VERB_PATTERN&&"future"===VERB_PATTERN?`${t["IMPF-1s"]}${DELIMETER} ${t["IMPF-1p"]}${e}<br/>${t["IMPF-2ms"]}, ${t["IMPF-2fs"]}${DELIMETER} ${t["IMPF-2mp"]}${e}<br/>הוא ${t["IMPF-3ms"]}, היא ${t["IMPF-3fs"]}${DELIMETER} הם ${t["IMPF-3mp"]}${e}<br/>${t["INF-L"]}`:`${t["AP-ms"]}${DELIMETER} ${t["AP-fs"]}${DELIMETER} ${t["AP-mp"]}${DELIMETER} ${t["INF-L"]}${e}<br/>${t["PERF-1s"]}${DELIMETER} ${t["PERF-3ms"]}${DELIMETER} ${t["PERF-3fs"]}${e}<br/>${t["IMPF-1s"]}${DELIMETER} ${t["IMPF-2ms"]}${DELIMETER} ${t["IMPF-3mp"]}`}function pealim(){var t=definePOS(),e=findRoot();let r=[],a={};if("noun"===t){parseIDs(noun_ids),"sc"in data_w&&data_tr.s==data_tr.sc.replace("-","")&&(data_w.s===data_w.sc.replace("־","")?[data_w,data_tr,data_wr].forEach(t=>t.sc="~"):data_tr.sc="~"),"pc"in data_w&&data_tr.p==data_tr.pc.replace("-","")&&(data_w.p===data_w.pc.replace("־","")?[data_w,data_tr,data_wr].forEach(t=>t.pc="~"):data_tr.pc="~");var n=patternNoun(data_w),i=patternNoun(data_tr),s=patternNoun(data_wr)}else if("adjective"===t){parseIDs(adj_ids);var n=patternAdj(data_w),i=patternAdj(data_tr),s=patternAdj(data_wr)}else if("verb"===t){parseIDs(verb_ids);var n=patternVerb(data_w,sep=";"),i=patternVerb(data_tr),s=patternVerb(data_wr)}console.log(`Text extracted: ${n}`),a.Niqqud=n,a.Transcription=i;let E=document.querySelector("table.conjugation-table"),d=document.createElement("p");d.dir="rtl",d.style.textAlign="left",d.innerHTML=n;let l=document.createElement("p");if(l.innerHTML=i,stripNiqqud(n)!==s.replaceAll(";","")){let p=document.createElement("p");p.dir="rtl",p.style.textAlign="left",p.innerHTML=s,r.push(p,d,l),a.Word=s}else r.push(d,l);if(e){let o=document.createElement("p");o.innerHTML=e,r.push(o),a.Root=e}E.before(...r),navigator.clipboard.writeText(JSON.stringify(a))}setTimeout(pealim,2e3);